{% extends "library/base.html" %}
{% load static %}

{% block home-header %}
    {% if user.is_authenticated %}
        <div class="invisible"></div>
    {% else %}
        <div class="home-header">
            <div class="home-content">
                <h1>Library Django</h1>
                <h3>Join us today.</h3>
                <div class="header-field"><a href="{% url 'login' %}"> Log in <i class="fa fa-sign-in"
                                                                                 aria-hidden="true"></i> </a></div>
                <div class="header-field"><a href="{% url 'register' %}"> Register </a></div>
            </div>
        </div>
        <div class="box">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="overlay"></div>
    {% endif %}

{% endblock home-header %}


{% block main %}
    {% load crispy_forms_filters %}

    <h2>NEWS</h2>

    <!-- Add article form -->
    {% if user.is_staff %}

        <button type="button" class="btn btn-dark" data-toggle="modal" data-target="#modalArticle">
            Add article <i class="fa fa-plus" aria-hidden="true" style="font-size: 12px; margin-left: 2px;"></i>
        </button>

        <!-- The Modal -->
        <div class="modal" id="modalArticle">
            <div class="modal-dialog">
                <div class="modal-content">

                    <div class="modal-header">
                        <h4 class="modal-title">Add article</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <form method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            {{ article_form|crispy }}
                            <input type="submit">
                        </form>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                    </div>

                </div>
            </div>
        </div>

    {% endif %}
    {% for article, content in articles %}
        <article class="news-card col-12">
            <div class="news-img">
                <img src="{{ article.image }}" alt="news image">
            </div>
            <div class="news-container">
                <div class="news-info">
                    <span>Published by {{ article.author }} on {{ article.date_posted }}</span>
                </div>
                <h1 class="news-title">{{ article.title }}</h1>

                <p class="news-content">{{ content|linebreaks }}</p>
                {% if content|length > 500 %}
                    <a href="#" class="news-read-more">Read more</a>
                {% endif %}
            </div>
            <div style="clear: both;"></div>
        </article>

        <script src="{% static 'library/js/scroll-out.js' %}"></script>
        <script type="text/javascript">
            ScrollOut({
                targets: 'h2, .news-card',
                once: true
            })
        </script>
    {% endfor %}
{% endblock main %}

{% block side %}
    <p>Side home</p>
{% endblock side %}

